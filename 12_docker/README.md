# Домашнее задание к занятию «4.1. Docker & Docker Compose: управление сервисами и упаковка приложений»

В качестве результата пришлите ссылки на ваши GitHub-проекты в личном кабинете студента на сайте [netology.ru](https://netology.ru).

Все задачи этого занятия нужно делать в **одном репозитории**.

**Важно**: если у вас что-то не получилось, то оформляйте Issue [по установленным правилам](../report-requirements.md).

**ВАЖНО**: НИ В КОЕМ СЛУЧАЕ НЕ ПОДСТАВЛЯЙТЕ ДАННЫЕ СВОИХ РЕАЛЬНЫХ КАРТ В КОД! Это очень частая "оплошность", когда разработчики случайно коммитят и заливают на GitHub "чувствительные" (sensitive) данные (ключи, логины, пароли, адреса и т.д.). Используйте генераторы вроде: https://www.freeformatter.com/credit-card-number-generator-validator.html

Если вы всё же "случайно" залили чувствительные данные на GitHub, то используйте [инструкцию по удалению данных](https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository). Кроме того, как бы это печально не было, рекомендуем вам заблокировать карту и заказать в банке новую.

## Как сдавать задачи

1. Создайте на вашем компьютере Go-модуль (см. доп.видео к первой лекции)
1. Инициализируйте в нём пустой Git-репозиторий. Репозиторий должен состоять только из маленьких букв иначе докер не зальет image в гитхаб
1. Добавьте в него готовый файл [.gitignore](../.gitignore)
1. Добавьте в этот же каталог остальные необходимые файлы (убедитесь, что они аккуратно разложены по пакетам)
1. Удостоверьтесь, что вы правильно отформатировали файлы (см. раздел Форматирование из [первого ДЗ](../01_std))
1. Сделайте необходимые коммиты
1. Создайте публичный репозиторий на GitHub и свяжите свой локальный репозиторий с удалённым
1. Сделайте пуш (удостоверьтесь, что ваш код появился на GitHub)
1. Ссылку на ваш проект отправьте в личном кабинете на сайте [netology.ru](https://netology.ru)
1. Задачи, отмеченные, как необязательные, можно не сдавать, это не повлияет на получение зачета (в этом ДЗ все задачи являются обязательными)

## Предисловие

Данное ДЗ будет представлять собой лабораторную работу, в рамках которой вы по инструкциям настроите определённые шаги.

Важно: перед выполнением ДЗ обязательно ознакомьтесь с инструкцией [по установке Docker](installation.md).

## Задача №1 - Создание Docker Image

В этой задаче мы научимся создавать Docker Image, в котором будет развёрнут ваш сервис.

Для этого вам нужно создать `Dockerfile` в соответствии [с инструкцией](dockerfile.md) и разместить в корневом каталоге вашего проекта (рядом с `go.mod`).

В качестве проекта для создания образа используйте "Заказ карты" из предыдущего ДЗ.

Итого, у вас должно быть: оформленный проект с пакетами, выложенный в репозиторий на GitHub вместе с `Dockerfile` (автотесты делать не нужно).

Убедитесь, что из вашего `Dockerfile` можно собрать образ, и контейнер, который создаётся из образа, запускается и нормально функционирует (приложение в контейнере отвечает на HTTP-запросы).

## Задача №2 - GitHub Packages*

**Важно**: это не обязательная задача, её (не)выполнение не влияет на получение зачёта по ДЗ.

**Важно**: если у вас не получилось установить Docker, вы можете не выполняйте эту задачу на Play With Docker (напишите в комментариях в ЛК, что у вас не получилось установить Docker).

В этой задаче мы научимся публиковать образ нашего приложения из первой задачи на сервисе [GitHub Packages](https://docs.github.com/en/packages). Это специальный реестр образов Docker, привязанный к вашему репозиторию на GitHub.

Соответственно, вы и все, у кого есть доступ к репозиторию смогут скачивать готовый образ (как мы делали на лекции), а не собирать его из `Dockerfile`.

Для этого вам нужно в соответствии [с инструкцией](packages.md) модернизировать ваш процесс сборки.

В качестве проекта используйте проект из предыдущей задачи.

Итого, у вас должно быть: оформленный проект с пакетами, выложенный в репозиторий на GitHub и опубликованный Docker Image в GitHub Packages (автотесты делать не нужно).

Убедитесь, что образ, опубликованный вами, скачивается, из него можно запустить контейнер, который нормально функционирует (приложение в контейнере отвечает на HTTP-запросы).

## Задача №3 - Multi-Stage Build*

**Важно**: это не обязательное задание, его выполнение не влияет на получение зачёта.

В этой задаче мы научимся использовать многостадийную сборку: в нашем случае, мы будем компилировать само приложение в контейнере, а затем из результатов компиляции создавать новый образ Docker.

Соответственно, собрать Docker Image можно будет даже не имея установленного компилятора Go на компьютере (достаточно будет Docker).

Для этого вам нужно в соответствии [с инструкцией](multi-stage.md) модернизировать ваш процесс сборки.

В качестве проекта используйте проект из предыдущей задачи.

Итого, у вас должно быть: оформленный проект с пакетами, выложенный в репозиторий на GitHub и `Dockerfile.multistage`, в котором описана многостадийная сборка. Автотесты на приложение делать не нужно.

